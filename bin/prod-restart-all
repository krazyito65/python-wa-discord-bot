#!/bin/bash
# Restart all production services
# Usage: bin/prod-restart-all

set -euo pipefail

echo "ğŸ”„ Restarting all production services..."

echo "  â€¢ Stopping services..."
sudo systemctl stop weakauras-bot weakauras-django

echo "  â€¢ Reloading systemd configuration..."
sudo systemctl daemon-reload

echo "  â€¢ Starting Discord bot..."
sudo systemctl start weakauras-bot

echo "  â€¢ Starting Django web interface..."
sudo systemctl start weakauras-django

echo "  â€¢ Reloading nginx..."
sudo systemctl reload nginx

echo "  â€¢ Checking service status..."
sudo systemctl status weakauras-bot weakauras-django nginx --no-pager -l

echo "âœ… All production services restarted successfully!"
echo ""
echo "ğŸ“Š Quick Status Check:"
echo "  â€¢ Discord Bot: $(sudo systemctl is-active weakauras-bot)"
echo "  â€¢ Django Web: $(sudo systemctl is-active weakauras-django)"
echo "  â€¢ Nginx Proxy: $(sudo systemctl is-active nginx)"
echo ""
echo "ğŸŒ Website: https://bot.weakauras.wtf"
echo "ğŸ“ Logs: bin/prod-logs-all"
