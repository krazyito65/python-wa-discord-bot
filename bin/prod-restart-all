#!/bin/bash
# Restart all production services
# Usage: bin/prod-restart-all

set -euo pipefail

echo "🔄 Restarting all production services..."

echo "  • Stopping services..."
sudo systemctl stop weakauras-bot weakauras-django

echo "  • Reloading systemd configuration..."
sudo systemctl daemon-reload

echo "  • Starting Discord bot..."
sudo systemctl start weakauras-bot

echo "  • Starting Django web interface..."
sudo systemctl start weakauras-django

echo "  • Reloading nginx..."
sudo systemctl reload nginx

echo "  • Checking service status..."
sudo systemctl status weakauras-bot weakauras-django nginx --no-pager -l

echo "✅ All production services restarted successfully!"
echo ""
echo "📊 Quick Status Check:"
echo "  • Discord Bot: $(sudo systemctl is-active weakauras-bot)"
echo "  • Django Web: $(sudo systemctl is-active weakauras-django)"
echo "  • Nginx Proxy: $(sudo systemctl is-active nginx)"
echo ""
echo "🌐 Website: https://bot.weakauras.wtf"
echo "📝 Logs: bin/prod-logs-all"
